# Exploits

## Table of Contents
* [Table of Contents](#table-of-contents)
* [Finding Exploits](#finding-exploits)
* [Compiling Exploits](#compiling-exploits)
   * [Compiling C Exploits](#compiling-c-exploits)
   * [Compiling C\+\+ Exploits](#compiling-c-exploits-1)
   * [Compiling Java Exploits](#compiling-java-exploits)


## Finding Exploits

### searchsploit
[Exploit Database](https://www.exploit-db.com/search) offline archive search

#### Options
```
-c: perform case-sensitive search (instead of default case-insensitive)
-m [EDB_ID]: copy exploit file from archive to current directory
-p [EDB_ID]: shows full path to exploit file in archive
-t: search in exploit title only
-w: show URL(s) to exploits in results (rather than archive file locations)
--nmap [NMAP_XML_FILE]: Checks all results in Nmap's XML output with service version
Combine with "-v" for as many results as possible
--exclude="[TERM0],[TERM1],...,[TERMn]": remove terms from results (ex. dos)
```

### Online resources for finding exploits
* [Exploit Database (Exploit-DB)](https://www.exploit-db.com/search)
* [Google](https://www.google.com/)
* [securityfocus](https://www.securityfocus.com/vulnerabilities)


## Compiling Exploits
Exploits written in C, C++, or Java (and potentially others) need to be compiled into an executable.

Exploits found on Exploit-DB that require compilation will often include compilation instructions.

For privilege escalation exploits (which are executed locally on a compromised system):
* Check if target system has compilation tools installed (this mainly applies to Linux hosts), and use those to compile the exploit.
* If this fails, compile the exploit on the Kali VM first before uploading to the compromised system.

### Compiling C Exploits
* For Linux exploits: ```gcc```
* For Windows exploits (cross-compiling): ```i686-w64-mingw32-gcc```

#### Options
```
-o [FILENAME]/[FILENAME].exe: output compiled executable to [FILENAME]
-m32: generate 32-bit executable (default)
-m64: generate 64-bit executable
-l[LIBNAME]: link executable with [LIBNAME]
-Wl,--hash-style=both: can sometimes be used to compile exploits for older Linux systems that do not have gcc/ld/etc.
```

#### Usage
```
gcc [SOURCE.c] [OPTIONS]
```
```
i686-w64-mingw32-gcc [SOURCE.c] [OPTIONS]
```

### Compiling C++ Exploits
* For Linux exploits: ```g++```
* For Windows exploits (cross-compiling): ```i686-w64-mingw32-g++```

#### Options
```
-o [FILENAME]/[FILENAME].exe: output compiled executable to [FILENAME]
-m32: generate 32-bit executable (default)
-m64: generate 64-bit executable
-l[LIBNAME]: link executable with [LIBNAME]
```

#### Usage
```
g++ [SOURCE.cpp] [OPTIONS]
```
```
i686-w64-mingw32-g++ [SOURCE.cpp] [OPTIONS]
```

### Compiling Java Exploits
Java exploit source code files (.java files) need to be named the same as the class they contain (ex. Main.java). The compiled file will have the same name with a .class extension (Main.class).

Using pre-compiled exploits is preferred, as Java is not backwards compatible (ex. compiled Java 8 code cannot be executed using a Java 7 runtime), so the Java code will need to be compiled using the same version as the Java runtime executing the exploit. This can be determined using the following commands:
```
java -version
javac -version
```

Old Java development kits and runtimes can be downloaded from the [Java Archives](https://www.oracle.com/java/technologies/oracle-java-archive-downloads.html) using a free Oracle account, which can be created [HERE](https://profile.oracle.com/myprofile/account/create-account.jspx).

Java exploits often depend on third-party library JAR files. For privilege escalation exploits, these can sometimes be copied off the compromised system. The same JAR files will then need to be referenced when executing the exploit.

#### Usage
```
javac [OPTIONS] [SOURCE_FILE].java
```

#### Options
```
-cp: set Java classpath
```

